
{% extends "admin/base_site.html" %}
{% load i18n admin_urls static %}

{% block title %}{% blocktranslate with name=opts.verbose_name %}Delete {{ name }}{% endblocktranslate %} | {{ site_title|default:_('LIMBS Orthopaedic Admin') }}{% endblock %}

{% block extrastyle %}
{{ block.super }}
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<style>
/* Material Dashboard Delete Confirmation Styling */
.delete-confirmation-container {
  padding: 2rem;
  background: linear-gradient(135deg, #fefefe 0%, #f5f7fa 100%);
  min-height: 100vh;
  font-family: 'Roboto', sans-serif;
}

.delete-header {
  background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
  color: white;
  padding: 2rem;
  border-radius: 16px;
  margin-bottom: 2rem;
  box-shadow: 0 10px 25px rgba(244, 67, 54, 0.3);
  position: relative;
  overflow: hidden;
}

.delete-header::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #ff5722, #f44336, #e91e63, #9c27b0);
}

.delete-header h1 {
  margin: 0;
  font-size: 2rem;
  font-weight: 300;
  display: flex;
  align-items: center;
}

.delete-header .material-icons {
  font-size: 2.5rem;
  margin-right: 1rem;
  opacity: 0.9;
}

.delete-subtitle {
  opacity: 0.9;
  font-size: 1rem;
  margin-top: 0.5rem;
}

/* Warning Card */
.warning-card {
  background: white;
  border-radius: 16px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  overflow: hidden;
  border: 2px solid #ff9800;
  margin-bottom: 2rem;
}

.warning-header {
  background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
  color: white;
  padding: 1.5rem 2rem;
  display: flex;
  align-items: center;
}

.warning-header .material-icons {
  font-size: 2rem;
  margin-right: 1rem;
}

.warning-header h2 {
  margin: 0;
  font-size: 1.25rem;
  font-weight: 500;
}

.warning-body {
  padding: 2rem;
}

.warning-message {
  font-size: 1.1rem;
  color: #1e266f;
  margin-bottom: 1.5rem;
  line-height: 1.6;
}

/* Object Info Card */
.object-info-card {
  background: white;
  border-radius: 16px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  overflow: hidden;
  border: 1px solid rgba(52, 189, 242, 0.1);
  margin-bottom: 2rem;
}

.object-info-header {
  background: linear-gradient(135deg, #34bdf2 0%, #1e266f 100%);
  color: white;
  padding: 1.5rem 2rem;
  display: flex;
  align-items: center;
}

.object-info-header .material-icons {
  font-size: 1.5rem;
  margin-right: 0.75rem;
}

.object-info-header h3 {
  margin: 0;
  font-size: 1.1rem;
  font-weight: 500;
}

.object-info-body {
  padding: 2rem;
}

.object-details {
  background: #f8f9fa;
  border-radius: 12px;
  padding: 1.5rem;
  border-left: 4px solid #34bdf2;
  margin-bottom: 1.5rem;
}

.object-name {
  font-size: 1.25rem;
  font-weight: 600;
  color: #1e266f;
  margin-bottom: 0.5rem;
  display: flex;
  align-items: center;
}

.object-name .material-icons {
  margin-right: 0.5rem;
  color: #34bdf2;
}

.object-type {
  color: #6c757d;
  font-size: 0.9rem;
  text-transform: capitalize;
}

/* Related Objects */
.related-objects {
  margin-top: 2rem;
}

.related-objects h4 {
  color: #1e266f;
  font-size: 1.1rem;
  margin-bottom: 1rem;
  display: flex;
  align-items: center;
}

.related-objects h4 .material-icons {
  margin-right: 0.5rem;
  color: #f44336;
}

.related-list {
  background: rgba(244, 67, 54, 0.05);
  border-radius: 8px;
  padding: 1rem;
  border-left: 4px solid #f44336;
}

.related-list ul {
  list-style: none;
  margin: 0;
  padding: 0;
}

.related-list li {
  padding: 0.5rem 0;
  border-bottom: 1px solid rgba(244, 67, 54, 0.1);
  display: flex;
  align-items: center;
}

.related-list li:last-child {
  border-bottom: none;
}

.related-list li::before {
  content: 'link';
  font-family: 'Material Icons';
  margin-right: 0.75rem;
  color: #f44336;
  font-size: 1rem;
}

/* Action Buttons */
.action-buttons {
  background: white;
  border-radius: 16px;
  padding: 2rem;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  border: 1px solid rgba(52, 189, 242, 0.1);
  display: flex;
  gap: 1rem;
  flex-wrap: wrap;
  justify-content: center;
}

.action-btn {
  padding: 1rem 2rem;
  border-radius: 25px;
  font-weight: 600;
  font-size: 0.95rem;
  text-decoration: none;
  border: none;
  cursor: pointer;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  position: relative;
  overflow: hidden;
  min-width: 150px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
}

.action-btn::before {
  font-family: 'Material Icons';
  margin-right: 0.75rem;
  font-size: 1.2rem;
}

.delete-btn {
  background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
  color: white;
  box-shadow: 0 6px 20px rgba(244, 67, 54, 0.4);
}

.delete-btn::before {
  content: 'delete_forever';
}

.delete-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(244, 67, 54, 0.5);
  background: linear-gradient(135deg, #d32f2f 0%, #c62828 100%);
  color: white;
  text-decoration: none;
}

.cancel-btn {
  background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
  color: white;
  box-shadow: 0 4px 15px rgba(108, 117, 125, 0.3);
}

.cancel-btn::before {
  content: 'cancel';
}

.cancel-btn:hover {
  background: linear-gradient(135deg, #495057 0%, #343a40 100%);
  transform: translateY(-2px);
  color: white;
  text-decoration: none;
  box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
}

/* Confirmation Checkbox */
.confirmation-section {
  background: white;
  border-radius: 16px;
  padding: 2rem;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  border: 2px solid #ff9800;
  margin-bottom: 2rem;
}

.confirmation-checkbox {
  display: flex;
  align-items: center;
  padding: 1rem;
  background: rgba(255, 152, 0, 0.05);
  border-radius: 8px;
  border: 1px solid rgba(255, 152, 0, 0.2);
}

.confirmation-checkbox input[type="checkbox"] {
  margin-right: 1rem;
  transform: scale(1.3);
  accent-color: #ff9800;
}

.confirmation-checkbox label {
  font-weight: 500;
  color: #1e266f;
  cursor: pointer;
  display: flex;
  align-items: center;
  margin: 0;
}

.confirmation-checkbox label .material-icons {
  margin-right: 0.5rem;
  color: #ff9800;
}

/* Progress Bar */
.progress-container {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
  margin-bottom: 2rem;
  display: none;
}

.progress-bar {
  width: 100%;
  height: 8px;
  background: #e9ecef;
  border-radius: 4px;
  overflow: hidden;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #f44336, #ff5722);
  width: 0%;
  transition: width 0.3s ease;
  border-radius: 4px;
}

/* Responsive Design */
@media (max-width: 768px) {
  .delete-confirmation-container {
    padding: 1rem;
  }
  
  .delete-header {
    padding: 1.5rem;
  }
  
  .delete-header h1 {
    font-size: 1.5rem;
  }
  
  .warning-body,
  .object-info-body {
    padding: 1rem;
  }
  
  .action-buttons {
    padding: 1.5rem;
    flex-direction: column;
    align-items: stretch;
  }
  
  .action-btn {
    width: 100%;
    margin-bottom: 0.5rem;
    min-width: auto;
  }
  
  .action-btn:last-child {
    margin-bottom: 0;
  }
}

/* Animations */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(30px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.fade-in-up {
  animation: fadeInUp 0.6s ease-out;
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-5px); }
  75% { transform: translateX(5px); }
}

.shake {
  animation: shake 0.5s ease-in-out;
}

/* Loading State */
.loading {
  display: inline-block;
  width: 16px;
  height: 16px;
  border: 2px solid rgba(255,255,255,0.3);
  border-radius: 50%;
  border-top-color: white;
  animation: spin 1s ease-in-out infinite;
  margin-left: 0.5rem;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
</style>
{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
  <a href="{% url 'admin:index' %}">{% translate 'Home' %}</a>
  &rsaquo; <a href="{% url 'admin:app_list' app_label=opts.app_label %}">{{ opts.app_config.verbose_name }}</a>
  &rsaquo; {% if has_view_permission %}<a href="{% url opts|admin_urlname:'changelist' %}">{{ opts.verbose_name_plural|capfirst }}</a>{% else %}{{ opts.verbose_name_plural|capfirst }}{% endif %}
  &rsaquo; {% blocktranslate with name=opts.verbose_name %}Delete {{ name }}{% endblocktranslate %}
</div>
{% endblock %}

{% block content %}
<div class="delete-confirmation-container">
  <!-- Delete Header -->
  <div class="delete-header fade-in-up">
    <h1>
      <span class="material-icons">warning</span>
      {% blocktranslate with name=opts.verbose_name %}Delete {{ name }}{% endblocktranslate %}
    </h1>
    <p class="delete-subtitle">This action cannot be undone</p>
  </div>

  <!-- Warning Card -->
  <div class="warning-card fade-in-up">
    <div class="warning-header">
      <span class="material-icons">error</span>
      <h2>{% translate "Deletion Warning" %}</h2>
    </div>
    <div class="warning-body">
      <p class="warning-message">
        {% blocktranslate with object=object %}Are you sure you want to delete "{{ object }}"? This action is permanent and cannot be undone.{% endblocktranslate %}
      </p>
      
      {% if related_objects %}
        <div class="related-objects">
          <h4>
            <span class="material-icons">link_off</span>
            {% translate "The following related objects will also be deleted:" %}
          </h4>
          <div class="related-list">
            <ul>
              {% for related in related_objects %}
                <li>{{ related }}</li>
              {% endfor %}
            </ul>
          </div>
        </div>
      {% endif %}
    </div>
  </div>

  <!-- Object Info Card -->
  <div class="object-info-card fade-in-up">
    <div class="object-info-header">
      <span class="material-icons">info</span>
      <h3>{% translate "Object Information" %}</h3>
    </div>
    <div class="object-info-body">
      <div class="object-details">
        <div class="object-name">
          <span class="material-icons">
            {% if opts.model_name == 'user' %}person
            {% elif opts.model_name == 'doctor' %}medical_services
            {% elif opts.model_name == 'appointment' %}event
            {% elif opts.model_name == 'service' %}healing
            {% elif opts.model_name == 'product' %}inventory_2
            {% elif opts.model_name == 'blogpost' %}article
            {% else %}folder
            {% endif %}
          </span>
          {{ object }}
        </div>
        <div class="object-type">{{ opts.verbose_name|capfirst }}</div>
      </div>
    </div>
  </div>

  <!-- Confirmation Section -->
  <div class="confirmation-section fade-in-up">
    <div class="confirmation-checkbox">
      <input type="checkbox" id="confirm-delete" onchange="toggleDeleteButton()">
      <label for="confirm-delete">
        <span class="material-icons">check_circle</span>
        {% translate "I understand that this action cannot be undone" %}
      </label>
    </div>
  </div>

  <!-- Progress Bar (hidden initially) -->
  <div class="progress-container" id="progress-container">
    <div class="progress-bar">
      <div class="progress-fill" id="progress-fill"></div>
    </div>
    <p style="text-align: center; margin-top: 1rem; color: #6c757d;">
      {% translate "Deleting..." %}
    </p>
  </div>

  <!-- Action Buttons -->
  <form method="post" id="delete-form">
    {% csrf_token %}
    <div class="action-buttons fade-in-up">
      <input type="hidden" name="post" value="yes">
      
      <button type="submit" class="action-btn delete-btn" id="delete-button" disabled>
        {% translate "Yes, Delete" %}
      </button>
      
      <a href="{% url opts|admin_urlname:'changelist' %}" class="action-btn cancel-btn">
        {% translate "Cancel" %}
      </a>
    </div>
  </form>
</div>

<script>
// Toggle delete button based on confirmation checkbox
function toggleDeleteButton() {
  const checkbox = document.getElementById('confirm-delete');
  const deleteButton = document.getElementById('delete-button');
  
  if (checkbox.checked) {
    deleteButton.disabled = false;
    deleteButton.style.opacity = '1';
    deleteButton.style.transform = 'translateY(0)';
  } else {
    deleteButton.disabled = true;
    deleteButton.style.opacity = '0.5';
    deleteButton.style.transform = 'translateY(2px)';
  }
}

// Handle form submission
document.addEventListener('DOMContentLoaded', function() {
  const form = document.getElementById('delete-form');
  const deleteButton = document.getElementById('delete-button');
  const progressContainer = document.getElementById('progress-container');
  const progressFill = document.getElementById('progress-fill');
  
  form.addEventListener('submit', function(e) {
    e.preventDefault();
    
    // Show confirmation dialog
    const confirmed = confirm('{% translate "This action cannot be undone. Are you absolutely sure?" %}');
    
    if (confirmed) {
      // Show progress bar
      progressContainer.style.display = 'block';
      
      // Disable delete button
      deleteButton.disabled = true;
      deleteButton.innerHTML = '{% translate "Deleting..." %} <span class="loading"></span>';
      
      // Animate progress bar
      let progress = 0;
      const interval = setInterval(() => {
        progress += Math.random() * 30;
        if (progress > 90) progress = 90;
        progressFill.style.width = progress + '%';
      }, 200);
      
      // Submit form after a short delay
      setTimeout(() => {
        clearInterval(interval);
        progressFill.style.width = '100%';
        form.submit();
      }, 1500);
    } else {
      // Shake the form if cancelled
      form.classList.add('shake');
      setTimeout(() => {
        form.classList.remove('shake');
      }, 500);
    }
  });
  
  // Add hover effects to action buttons
  const actionButtons = document.querySelectorAll('.action-btn');
  actionButtons.forEach(btn => {
    btn.addEventListener('mouseenter', function() {
      if (!this.disabled) {
        this.style.transform = 'translateY(-3px)';
      }
    });
    
    btn.addEventListener('mouseleave', function() {
      if (!this.disabled) {
        this.style.transform = 'translateY(0)';
      }
    });
  });
});
</script>
{% endblock %}
