
{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_modify %}

{% block title %}{% if add %}{% blocktrans with name=opts.verbose_name %}Add {{ name }}{% endblocktrans %}{% else %}{% blocktrans with name=opts.verbose_name %}Change {{ name }}{% endblocktrans %}{% endif %} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block extrastyle %}
{{ block.super }}
<style>
/* Material Dashboard Change Form Styling */
.change-form-container {
  background: var(--cream);
  min-height: calc(100vh - 120px);
  padding: 2rem;
}

.change-form-header {
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  color: white;
  padding: 2rem;
  border-radius: 16px;
  margin-bottom: 2rem;
  box-shadow: var(--shadow-lg);
  position: relative;
  overflow: hidden;
}

.change-form-header::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #4caf50, #2196f3, #ff9800, #f44336);
}

.change-form-title {
  font-size: 2rem;
  font-weight: 300;
  margin: 0;
  display: flex;
  align-items: center;
}

.change-form-title .material-icons {
  font-size: 2.5rem;
  margin-right: 1rem;
  opacity: 0.9;
}

.form-container {
  background: white;
  border-radius: 16px;
  box-shadow: var(--shadow-md);
  overflow: hidden;
  border: 1px solid rgba(52, 189, 242, 0.1);
  margin-bottom: 2rem;
}

.form-section {
  border-bottom: 1px solid #e9ecef;
}

.form-section:last-child {
  border-bottom: none;
}

.form-section h2 {
  background: linear-gradient(135deg, var(--light) 0%, #e9ecef 100%);
  margin: 0;
  padding: 1.5rem 2rem;
  font-size: 1.1rem;
  font-weight: 500;
  color: var(--secondary);
  border-bottom: 2px solid var(--primary);
}

.form-section .form-row {
  padding: 1.5rem 2rem;
  border-bottom: 1px solid #f0f0f0;
  transition: var(--transition);
}

.form-section .form-row:last-child {
  border-bottom: none;
}

.form-section .form-row:hover {
  background: rgba(52, 189, 242, 0.02);
}

.form-row label {
  display: block;
  margin-bottom: 0.75rem;
  font-weight: 500;
  color: var(--secondary);
  font-size: 0.9rem;
}

.form-row input[type="text"],
.form-row input[type="password"],
.form-row input[type="email"],
.form-row input[type="url"],
.form-row input[type="number"],
.form-row input[type="tel"],
.form-row input[type="date"],
.form-row input[type="time"],
.form-row input[type="datetime-local"],
.form-row textarea,
.form-row select {
  width: 100%;
  padding: 0.75rem 1rem;
  border: 2px solid #e0e0e0;
  border-radius: 8px;
  font-size: 0.9rem;
  transition: var(--transition);
  background: white;
  outline: none;
}

.form-row input:focus,
.form-row textarea:focus,
.form-row select:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(52, 189, 242, 0.1);
  transform: translateY(-1px);
}

.form-row .helptext {
  font-size: 0.8rem;
  color: #6c757d;
  margin-top: 0.5rem;
  font-style: italic;
}

.form-row .errorlist {
  background: rgba(244, 67, 54, 0.1);
  border: 1px solid #f44336;
  border-radius: 6px;
  padding: 0.5rem 1rem;
  margin-top: 0.5rem;
  color: #c62828;
  list-style: none;
}

.form-row .errorlist li {
  margin: 0;
  font-size: 0.8rem;
}

/* Inline Forms */
.inline-group {
  background: white;
  border-radius: 12px;
  box-shadow: var(--shadow-md);
  margin-bottom: 2rem;
  border: 1px solid rgba(52, 189, 242, 0.1);
  overflow: hidden;
}

.inline-group h2 {
  background: linear-gradient(135deg, var(--info) 0%, #1976d2 100%);
  color: white;
  margin: 0;
  padding: 1.5rem 2rem;
  font-size: 1rem;
  font-weight: 500;
}

.inline-related {
  padding: 1.5rem;
  border-bottom: 1px solid #e9ecef;
}

.inline-related:last-child {
  border-bottom: none;
}

.add-row {
  padding: 1rem 2rem;
  background: rgba(52, 189, 242, 0.05);
}

.add-row a {
  color: var(--primary);
  text-decoration: none;
  font-weight: 500;
  display: inline-flex;
  align-items: center;
  padding: 0.5rem 1rem;
  border-radius: 20px;
  background: white;
  border: 2px solid var(--primary);
  transition: var(--transition);
}

.add-row a::before {
  content: 'âž•';
  margin-right: 0.5rem;
}

.add-row a:hover {
  background: var(--primary);
  color: white;
  transform: translateY(-1px);
}

/* Submit Row */
.submit-row {
  background: white;
  border-radius: 12px;
  padding: 2rem;
  box-shadow: var(--shadow-md);
  display: flex;
  gap: 1rem;
  align-items: center;
  border: 1px solid rgba(52, 189, 242, 0.1);
}

.submit-row input[type="submit"] {
  background: linear-gradient(135deg, var(--success) 0%, #45a049 100%);
  color: white;
  border: none;
  padding: 0.75rem 2rem;
  border-radius: 25px;
  font-weight: 500;
  cursor: pointer;
  transition: var(--transition);
  box-shadow: var(--shadow-sm);
}

.submit-row input[type="submit"]:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

.submit-row .deletelink {
  background: linear-gradient(135deg, var(--danger) 0%, #d32f2f 100%);
  color: white;
  padding: 0.75rem 2rem;
  border-radius: 25px;
  text-decoration: none;
  font-weight: 500;
  transition: var(--transition);
  box-shadow: var(--shadow-sm);
}

.submit-row .deletelink:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
  color: white;
  text-decoration: none;
}

/* Object Tools */
.object-tools {
  background: white;
  border-radius: 12px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  box-shadow: var(--shadow-md);
  border: 1px solid rgba(52, 189, 242, 0.1);
}

.object-tools li {
  display: inline-block;
  margin-right: 1rem;
}

.object-tools a {
  background: linear-gradient(135deg, var(--info) 0%, #1976d2 100%);
  color: white;
  padding: 0.75rem 1.5rem;
  border-radius: 25px;
  text-decoration: none;
  font-weight: 500;
  transition: var(--transition);
  box-shadow: var(--shadow-sm);
  display: inline-flex;
  align-items: center;
}

.object-tools a:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
  color: white;
  text-decoration: none;
}

/* CKEditor Styling */
.django-ckeditor-widget {
  border-radius: 8px;
  overflow: hidden;
  border: 2px solid #e0e0e0;
}

.django-ckeditor-widget:focus-within {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(52, 189, 242, 0.1);
}

/* Responsive Design */
@media (max-width: 768px) {
  .change-form-container {
    padding: 1rem;
  }
  
  .change-form-header {
    padding: 1.5rem;
  }
  
  .change-form-title {
    font-size: 1.5rem;
  }
  
  .form-section .form-row {
    padding: 1rem;
  }
  
  .submit-row {
    flex-direction: column;
    align-items: stretch;
  }
  
  .submit-row input[type="submit"],
  .submit-row .deletelink {
    text-align: center;
  }
}
</style>
{% endblock %}

{% block content %}
<div class="change-form-container">
  <div class="change-form-header">
    <h1 class="change-form-title">
      <span class="material-icons">{% if add %}add{% else %}edit{% endif %}</span>
      {% if add %}
        {% blocktrans with name=opts.verbose_name %}Add {{ name }}{% endblocktrans %}
      {% else %}
        {% blocktrans with name=opts.verbose_name %}Change {{ name }}{% endblocktrans %}
      {% endif %}
    </h1>
  </div>

  {% block object-tools %}
    {% if change %}{% if not is_popup %}
      <ul class="object-tools">
        {% block object-tools-items %}
          <li>
            {% url opts|admin_urlname:'history' original.pk|admin_urlquote as history_url %}
            <a href="{% add_preserved_filters history_url %}" class="historylink">History</a>
          </li>
          {% if has_absolute_url %}
            <li>
              <a href="{{ absolute_url }}" class="viewsitelink">View on site</a>
            </li>
          {% endif %}
        {% endblock %}
      </ul>
    {% endif %}{% endif %}
  {% endblock %}

  <form method="post"{% if has_file_field %} enctype="multipart/form-data"{% endif %} novalidate>{% csrf_token %}
    {% block form_top %}{% endblock %}
    
    <div class="form-container">
      {% if is_popup %}<input type="hidden" name="{{ is_popup_var }}" value="1">{% endif %}
      {% if to_field %}<input type="hidden" name="{{ to_field_var }}" value="{{ to_field }}">{% endif %}
      {% if save_on_top %}{% block submit_buttons_top %}{% submit_row %}{% endblock %}{% endif %}
      
      {% if errors %}
        <div class="form-section">
          <div class="form-row">
            <div class="errorlist">
              {% for error in errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </div>
          </div>
        </div>
      {% endif %}

      {% block field_sets %}
        {% for fieldset in adminform %}
          {% include "admin/includes/fieldset.html" %}
        {% endfor %}
      {% endblock %}

      {% block after_field_sets %}{% endblock %}

      {% block inline_field_sets %}
        {% for inline_admin_formset in inline_admin_formsets %}
          {% include inline_admin_formset.opts.template %}
        {% endfor %}
      {% endblock %}

      {% block after_related_objects %}{% endblock %}
    </div>

    {% block submit_buttons_bottom %}{% submit_row %}{% endblock %}

    {% block admin_change_form_document_ready %}
      <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function() {
          // Add material ripple effect to buttons
          const buttons = document.querySelectorAll('input[type="submit"], .deletelink, .object-tools a');
          buttons.forEach(button => {
            button.addEventListener('click', function(e) {
              const ripple = document.createElement('span');
              const rect = this.getBoundingClientRect();
              const size = Math.max(rect.width, rect.height);
              const x = e.clientX - rect.left - size / 2;
              const y = e.clientY - rect.top - size / 2;
              
              ripple.style.width = ripple.style.height = size + 'px';
              ripple.style.left = x + 'px';
              ripple.style.top = y + 'px';
              ripple.classList.add('ripple');
              
              this.appendChild(ripple);
              
              setTimeout(() => {
                ripple.remove();
              }, 600);
            });
          });
        });
      </script>
    {% endblock %}

    {% block form_bottom %}{% endblock %}
  </form>
</div>

<style>
.ripple {
  position: absolute;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.6);
  transform: scale(0);
  animation: ripple-animation 0.6s linear;
  pointer-events: none;
}

@keyframes ripple-animation {
  to {
    transform: scale(4);
    opacity: 0;
  }
}
</style>
{% endblock %}
